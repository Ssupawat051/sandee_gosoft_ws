<?xml version="1.0" ?>

<robot name = "sandee">

<!--base-->

    <link name ="base_link">
        <visual>

            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Base.stl"/>      
            </geometry>

        </visual>

        <inertial>
            <mass value = "15"/> <!-- Kg -->
            <inertia ixx = "0.000214" ixy = "0.0" ixz = "0.0" iyy = "0.000156" iyz = "0.0" izz = "0.000315"/>
        </inertial>

        <collision>
            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Base.stl"/>       
            </geometry>
        </collision>

    </link>
    
    

<!--left_wheel-->

    <link name ="left_wheel_link">
        <visual>
            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Wheel_L.stl"/>         
            </geometry>
        </visual>

        <inertial>
            <mass value = "0.5"/> <!-- Kg -->
            <inertia ixx = "0.0" ixy = "0.0" ixz = "0.0" iyy = "0.000001" iyz = "0.0" izz = "0.0"/>
        </inertial>

        <collision>
            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Wheel_L.stl"/>       
            </geometry>
        </collision>

    </link>
       
    <joint name ="left_wheel_joint" type = "continuous">
        <origin xyz = "0 0.21 -0.0068" rpy = "0 0 0"/>
        <parent link = "base_link"/>
        <child link = "left_wheel_link"/>
        <limit effort = "30" velocity = "10"/>
        <axis rpy = "0 0 0" xyz = "0 1 0"/>
    </joint>


<!--right_wheel-->

    <link name ="right_wheel_link">
        <visual>
            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Wheel_R.stl"/>         
            </geometry>           
        </visual>

        <inertial>
            <mass value = "0.5"/> <!-- Kg -->
            <inertia ixx = "0.0" ixy = "0.0" ixz = "0.0" iyy = "0.000001" iyz = "0.0" izz = "0.0"/>
        </inertial>

        <collision>
            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Wheel_R.stl"/>       
            </geometry>
        </collision>

    </link>
       
    <joint name ="right_wheel_joint" type = "continuous">
        <origin xyz = "0 -0.21 -0.0068" rpy = "0 0 0"/>
        <parent link = "base_link"/>
        <child link = "right_wheel_link"/>
        <limit effort = "30" velocity = "10"/>
        <axis rpy = "0 0 0" xyz = "0 1 0"/>
    </joint>

<!--lidar_down-->

    <link name ="lidar_down_link">
        <visual>
            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Lidar_Down.stl"/>         
            </geometry>
            <material name="grey">
                <color rgba="0.2 0.2 0.2 1.0"/>
            </material>
        </visual>
        
        <inertial>
            <mass value = "0.15"/> <!-- Kg -->
            <inertia ixx = "0.0" ixy = "0.0" ixz = "0.0" iyy = "0.0" iyz = "0.0" izz = "0.0"/>
        </inertial>

        <collision>
            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Lidar_Down.stl"/>       
            </geometry>
        </collision>
 
    </link>
       
    <joint name ="lidar_down_joint" type = "fixed">
        <origin xyz = "0 0 0.172" rpy = "0 0 0"/>
        <parent link = "base_link"/>
        <child link = "lidar_down_link"/>
        <limit effort = "0" velocity = "0"/>
        <axis rpy = "0 0 0" xyz = "0 0 0"/>
    </joint>

<!--lidar_up-->
    <link name = "lidar_up_link">
        <visual>
            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Lidar_Up.stl"/>        
            </geometry>
            <material name="green">
                <color rgba="0.0 0.8 0.0 1.0"/>
            </material>
        </visual>

        <inertial>
            <mass value = "0.05"/> <!-- Kg -->
            <inertia ixx = "0.0" ixy = "0.0" ixz = "0.0" iyy = "0.0" iyz = "0.0" izz = "0.0"/>
        </inertial>

        <collision>
            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Lidar_Up.stl"/>       
            </geometry>
        </collision>

   </link>

    <joint name = "lidar_up_joint" type = "fixed">
        <origin xyz = "0 0 0.2" rpy = "0 0 0"/>
        <parent link = "base_link"/>
        <child link = "lidar_up_link"/>
        <limit effort = "0" velocity = "0"/>
        <axis rpy = "0 0 0" xyz = "0 0 0"/>
    </joint>

    <!--caster1-->

    <link name = "caster1_link">
        <visual>
            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Caster1.stl"/>        
            </geometry>
        </visual>

        <inertial>
            <mass value = "0.5"/> <!-- Kg -->
            <inertia ixx = "0.0" ixy = "0.0" ixz = "0.0" iyy = "0.0" iyz = "0.0" izz = "0.0"/>
        </inertial>

        <collision>
            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Caster1.stl"/>       
            </geometry>
        </collision>

    </link>

    <joint name = "caster1_joint" type = "fixed">
        <origin xyz = "0.15 0.139 -0.055" rpy = "0 0 0"/>
        <parent link = "base_link"/>
        <child link = "caster1_link"/>
        <limit effort = "0" velocity = "0"/>
        <axis rpy = "0 0 0" xyz = "0 0 0"/>
    </joint>


<!--caster2-->

    <link name = "caster2_link">
        <visual>
            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Caster2.stl"/>        
            </geometry>
        </visual>

        <inertial>
            <mass value = "0.5"/> <!-- Kg -->
            <inertia ixx = "0.0" ixy = "0.0" ixz = "0.0" iyy = "0.0" iyz = "0.0" izz = "0.0"/>
        </inertial>

        <collision>
            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Caster2.stl"/>       
            </geometry>
        </collision>

    </link>

    <joint name = "caster2_joint" type = "fixed">
        <origin xyz = "0.15 -0.139 -0.055" rpy = "0 0 0"/>
        <parent link = "base_link"/>
        <child link = "caster2_link"/>
        <limit effort = "0" velocity = "0"/>
        <axis rpy = "0 0 0" xyz = "0 0 0"/>
    </joint>


<!--caster3-->

     <link name = "caster3_link">
        <visual>
            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Caster3.stl"/>        
            </geometry>
        </visual>

        <inertial>
            <mass value = "0.5"/> <!-- Kg -->
            <inertia ixx = "0.0" ixy = "0.0" ixz = "0.0" iyy = "0.0" iyz = "0.0" izz = "0.0"/>
        </inertial>

        <collision>
            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Caster3.stl"/>       
            </geometry>
        </collision>

    </link>

    <joint name = "caster3_joint" type = "fixed">
        <origin xyz = "-0.15 0.139 -0.055" rpy = "0 0 0"/>
        <parent link = "base_link"/>
        <child link = "caster3_link"/>
        <limit effort = "0" velocity = "0"/>
        <axis rpy = "0 0 0" xyz = "0 0 0"/>
    </joint>


<!--caster4-->

     <link name = "caster4_link">
        <visual>
            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Caster4.stl"/>        
            </geometry>
        </visual>

        <inertial>
            <mass value = "0.5"/> <!-- Kg -->
            <inertia ixx = "0.0" ixy = "0.0" ixz = "0.0" iyy = "0.0" iyz = "0.0" izz = "0.0"/>
        </inertial>

        <collision>
            <origin xyz = "0 0 0" rpy = "0 0 0"/>
            <geometry>
                <mesh filename = "package://urdf_sim/model/meshes/Caster4.stl"/>       
            </geometry>
        </collision>
 

    </link>

    <joint name = "caster4_joint" type = "fixed">
        <origin xyz = "-0.15 -0.139 -0.055" rpy = "0 0 0"/>
        <parent link = "base_link"/>
        <child link = "caster4_link"/>
        <limit effort = "0" velocity = "0"/>
        <axis rpy = "0 0 0" xyz = "0 0 0"/>
    </joint>
    

    <gazebo reference = "base_link">
        <material> Gazebo/Green </material>
    </gazebo>

    <gazebo reference = "left_wheel_link">
        <material> Gazebo/Yellow </material>
        <mu1 value = "0.2"/>
        <mu2 value = "0.18"/>
        <kp value = "1000"/>
        <kd value = "100"/>
    </gazebo>

    <gazebo reference = "right_wheel_link">
        <material> Gazebo/Purple </material>
        <mu1 value = "0.2"/>
        <mu2 value = "0.18"/>
        <kp value = "1000"/>
        <kd value = "100"/>
    </gazebo>

    <gazebo reference = "lidar_up_link">
        <material> Gazebo/Indigo </material>
    </gazebo>

    <gazebo reference = "lidar_down_link">
        <material> Gazebo/Orange </material>
    </gazebo>

    <gazebo reference = "caster1_link">
        <material> Gazebo/BlueGlow </material>
        <mu1 value = "0.03"/>
        <mu2 value = "0.028"/>
        <kp value = "1000"/>
        <kd value = "100"/>
    </gazebo>

    <gazebo reference = "caster2_link">
        <material> Gazebo/YellowGlow </material>
        <mu1 value = "0.03"/>
        <mu2 value = "0.028"/>
        <kp value = "1000"/>
        <kd value = "100"/>
    </gazebo>

    <gazebo reference = "caster3_link">
        <material> Gazebo/PurpleGlow </material>
        <mu1 value = "0.03"/>
        <mu2 value = "0.028"/>
        <kp value = "1000"/>
        <kd value = "100"/>
    </gazebo>

    <gazebo reference = "caster4_link">
        <material> Gazebo/TurquoiseGlow  </material>
        <mu1 value = "0.03"/>
        <mu2 value = "0.028"/>
        <kp value = "1000"/>
        <kd value = "100"/>
    </gazebo>

    <gazebo>
    <plugin filename = "libgazebo_ros_diff_drive.so" name = "differential_drive_controller">
        <alwatsOn>true</alwatsOn>
        <updateRate>20</updateRate>
        <leftJoint>left_wheel_joint</leftJoint>
        <rightJoint>right_wheel_joint</rightJoint>
        <wheelSeparation>4.2</wheelSeparation>
        <wheelDiameter>2.4384</wheelDiameter>
        <torque>3.4</torque>
        <commandTopic>cmd_vel</commandTopic>
        <odometryTopic>odom</odometryTopic>
        <odometryFrame>odom</odometryFrame>
        <robotBaseFrame>base_link</robotBaseFrame>
    </plugin>
    </gazebo>

    <gazebo reference = "lidar_up_link">
        <sensor type = "ray" name ="sandee_laser_sensor">
        <pose>0 0 0 0 0 0</pose>
        <visualize>true</visualize>
        <update_rate>5.5</update_rate>
        <ray>
            <scan>
                <horizontal>
                    <samples>720</samples>
                    <resolution>1</resolution>
                    <min_angle>-3.14</min_angle>
                    <max_angle>3.14</max_angle>
                </horizontal>
            </scan>

            <rang>
                <min>0.067</min>
                <max>12.0</max>
                <resolution>0.01</resolution>
            </rang>

            <noise>
                <type>gaussian</type>
                <mean>0.0</mean>
                <stddev>0.01</stddev>
            </noise>
        </ray>

        <plugin name = "gazebo_ros_head_hokuyo_controller" filename = "libgazebo_ros_laser.so">
        <topicName>/scan</topicName>
        <frameName>lidar_up_link</frameName>
        </plugin>
        </sensor>
    </gazebo>
    
</robot>